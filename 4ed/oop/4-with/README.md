
Рассмотрим, как использовать для работы с базой данных инструкцию with, с которой мы сталивались во время открытия файлов: 

with open("") as file:
   file.read()

Напомним, что блок with автоматически закрывал файл и нам не приходислось специально указывать file.close().


К инструкции with можно подключить любой класс, который реализует по меньшей мере два специальных (магических)
метода: __enter__ и __exit__. Говорят, что такой класс реализует диспетчер контекста.

В момент передачи объекта в инструкцию with интерпретатор Python вызывает метод __enter__ перед началом 
выполнения тела инструкции with. Таким образом внутри __enter__ можно поместить код для настройки. 

После завершения выполнения тела with вызывается метод __exit__, поэтому внутри расположим завершающий код.


